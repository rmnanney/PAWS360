{
  "info": {
    "name": "PAWS360 Seed Database v2",
    "_postman_id": "c46d4d7a-2f7a-4b51-9b5a-2f9b2a9bc0b6",
    "description": "Seeds PAWS360 with users (with ssn/ethnicity/gender/nationality), degree programs + student program assignments, buildings, classrooms, courses (with costs), sections, staff assignments, and enrollments.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Seed All",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/",
          "host": ["{{baseUrl}}"],
          "path": [""]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "(async function () {\n",
              "  const baseUrl = pm.environment.get('baseUrl') || 'http://localhost:8080';\n",
              "  const academicYear = parseInt(pm.environment.get('academicYear') || '2025');\n",
              "  const term = pm.environment.get('term') || 'Fall';\n",
              "  pm.environment.set('baseUrl', baseUrl);\n",
              "  pm.environment.set('academicYear', academicYear);\n",
              "  pm.environment.set('term', term);\n",
              "  function sleep(ms){ return new Promise(r => setTimeout(r, ms)); }\n",
              "  function http(req){ return new Promise((resolve, reject) => pm.sendRequest(req, (e,r)=> e?reject(e):resolve(r))); }\n",
              "  function pad(n,w){ return String(n).padStart(w,'0'); }\n",
              "  function aliasFromDept(dept){ const parts=dept.split('_'); let a=parts.map(p=>p[0]).join(''); if (a.length<3) a=(a+'XXX').slice(0,3); return a.slice(0,5).toUpperCase(); }\n",
              "\n",
              "  // Users\n",
              "  const counts = { STUDENT: 20, PROFESSOR: 10, INSTRUCTOR: 10, TA: 10, ADVISOR: 5, COUNSELOR: 5, MENTOR: 5, FACULTY: 10, STAFF: 5, Administrator: 2, Super_Administrator: 1 };\n",
              "  const users = []; let idx=1;\n",
              "  function makeUser(role, i){ const email=role.toLowerCase()+i+'@seed.uwm.edu'; return {\n",
              "    firstname: role+'User'+i, middlename: '', lastname: 'UWM',\n",
              "    dob: '1995-01-' + pad((i % 28) + 1, 2),\n",
              "    ssn: '999-7' + pad(i % 89, 2) + '-' + pad((1000 + i) % 9999, 4),\n",
              "    ethnicity: 'WHITE', gender: (i % 2 === 0 ? 'MALE' : 'FEMALE'), nationality: 'UNITED_STATES',\n",
              "    email: email, password: 'P@ssw0rd!'+i,\n",
              "    addresses: [{ id: null, address_type: 'HOME', street_address_1: '1234 Seed St', street_address_2: null, po_box: null, city: 'Milwaukee', us_states: 'WI', zipcode: '53211' }],\n",
              "    countryCode: 'US', phone: '414555'+pad(i,4), status: 'ACTIVE', role: role\n",
              "  }; }\n",
              "  Object.entries(counts).forEach(([r,c])=>{ for(let i=1;i<=c;i++){ users.push(makeUser(r, idx++)); }});\n",
              "  const createdUsers = []; const studentEmails = []; const staff = { PROFESSOR:[], INSTRUCTOR:[], TA:[] };\n",
              "  for (const u of users){ const res = await http({ url: baseUrl+'/users/create', method:'POST', header:{'Content-Type':'application/json'}, body:{mode:'raw', raw: JSON.stringify(u)} }); if (res.code>=200 && res.code<300){ try { const data=res.json(); createdUsers.push(data); if (data.role==='STUDENT') studentEmails.push(data.email); if (data.role==='PROFESSOR') staff.PROFESSOR.push(data.user_id); if (data.role==='INSTRUCTOR') staff.INSTRUCTOR.push(data.user_id); if (data.role==='TA') staff.TA.push(data.user_id); } catch(e){} } await sleep(5);} \n",
              "\n",
              "  // Resolve student IDs\n",
              "  const studentIds = [];\n",
              "  for (const email of studentEmails){ const r = await http({ url: baseUrl + '/users/student-id?email=' + encodeURIComponent(email), method:'GET' }); if (r.code>=200 && r.code<300) { try { const d=r.json(); if (typeof d.student_id === 'number' && d.student_id>0) studentIds.push(d.student_id); } catch(e){} } await sleep(3);}\n",
              "\n",
              "  // Degree programs\n",
              "  const degrees = [ {code:'BS-CS', name:'B.S. Computer Science', totalCreditsRequired:120}, {code:'BS-ME', name:'B.S. Mechanical Engineering', totalCreditsRequired:130}, {code:'BA-PSY', name:'B.A. Psychology', totalCreditsRequired:120} ];\n",
              "  const degreeIds = []; for (const d of degrees){ const r = await http({ url: baseUrl+'/academics/admin/programs', method:'POST', header:{'Content-Type':'application/json'}, body:{mode:'raw', raw: JSON.stringify(d)} }); if (r.code>=200 && r.code<300){ try { degreeIds.push(r.json().id); } catch(e){} } await sleep(5);} \n",
              "  for (let i=0;i<studentIds.length;i++){ const sid=studentIds[i]; const deg = degreeIds[i % degreeIds.length]; const term = (i % 2 === 0 ? 'Spring' : 'Fall'); const year = 2027 + (i % 3); const body = { degreeId: deg, expectedGradTerm: term, expectedGradYear: year, primary: true }; await http({ url: baseUrl + '/academics/admin/students/' + sid + '/program', method:'POST', header:{'Content-Type':'application/json'}, body:{mode:'raw', raw: JSON.stringify(body)} }); if (i % 10 === 0) await sleep(10);} \n",
              "\n",
              "  // Buildings\n",
              "  const buildings = [ { code:'EMS', name:'Engineering & Mathematical Sciences Building', campus:'Milwaukee Main Campus', accessible:true, notes:'' }, { code:'KIRC', name:'Kenwood Interdisciplinary Research Complex', campus:'Milwaukee Main Campus', accessible:true, notes:'' } ];\n",
              "  const buildingIds = []; for (const b of buildings){ const r=await http({ url: baseUrl+'/courses/buildings', method:'POST', header:{'Content-Type':'application/json'}, body:{mode:'raw', raw: JSON.stringify(b)} }); if (r.code>=200 && r.code<300){ try { buildingIds.push(r.json().id); } catch(e){} } await sleep(5);} \n",
              "  // Classrooms\n",
              "  const classroomIdsByBuilding = {}; for (const bid of buildingIds){ classroomIdsByBuilding[bid]=[]; for (let i=1;i<=12;i++){ const dto={ buildingId: bid, roomNumber: String(100+i), capacity: 25 + ((i%6)*5), roomType:'GENERAL_PURPOSE', features:['Projector','Whiteboard'] }; const r=await http({ url: baseUrl+'/courses/classrooms', method:'POST', header:{'Content-Type':'application/json'}, body:{mode:'raw', raw: JSON.stringify(dto)} }); if (r.code>=200 && r.code<300){ try{ classroomIdsByBuilding[bid].push(r.json().id);}catch(e){} } await sleep(3);} }\n",
              "\n",
              "  // Courses with cost\n",
              "  const departments=['COMPUTER_SCIENCE','MECHANICAL_ENGINEERING','PSYCHOLOGY']; const methods=['IN_PERSON','ONLINE','HYBRID']; const courseIds=[];\n",
              "  for (const dept of departments){ for (let i=1;i<=6;i++){ const code=aliasFromDept(dept)+'-'+pad(100+i,3); const req={ courseCode: code, courseName: dept.replace(/_/g,' ')+' '+(100+i), courseDescription: 'Seeded course', department: dept, courseLevel: 'UG', creditHours: 3, deliveryMethod: methods[i%methods.length], courseCost: 1350.00, active: true, catalogMaxEnrollment: 100, academicYear: academicYear, term: term }; const r=await http({ url: baseUrl+'/courses', method:'POST', header:{'Content-Type':'application/json'}, body:{mode:'raw', raw: JSON.stringify(req)} }); if (r.code>=200 && r.code<300){ try{ courseIds.push(r.json().courseId);}catch(e){} } await sleep(4);} }\n",
              "\n",
              "  // Sections (1 lecture + 1 lab)\n",
              "  const lectures=[]; const labsByLecture={}; function pick(arr){ return arr[Math.floor(Math.random()*arr.length)]; }\n",
              "  for (const courseId of courseIds){ const b=pick(buildingIds); const c=pick(classroomIdsByBuilding[b]); const lecReq={ sectionId:null, courseId, sectionCode:'LEC-'+pad(lectures.length+1,3), sectionType:'LECTURE', parentSectionId:null, buildingId:b, classroomId:c, meetingDays:['MONDAY','WEDNESDAY'], startTime:'09:00:00', endTime:'10:15:00', maxEnrollment:30, waitlistCapacity:10, autoEnrollWaitlist:true, consentRequired:false, term: term, academicYear: academicYear }; const lr=await http({ url: baseUrl+'/courses/sections', method:'POST', header:{'Content-Type':'application/json'}, body:{mode:'raw', raw: JSON.stringify(lecReq)} }); let lecId=null; if (lr.code>=200 && lr.code<300){ try { lecId=lr.json().sectionId; } catch(e){} } if (!lecId) continue; lectures.push(lecId); const b2=pick(buildingIds); const c2=pick(classroomIdsByBuilding[b2]); const labReq={ sectionId:null, courseId, sectionCode:'LAB-001', sectionType:'LAB', parentSectionId:lecId, buildingId:b2, classroomId:c2, meetingDays:['FRIDAY'], startTime:'11:00:00', endTime:'12:45:00', maxEnrollment:20, waitlistCapacity:10, autoEnrollWaitlist:true, consentRequired:false, term: term, academicYear: academicYear }; const lr2=await http({ url: baseUrl+'/courses/sections', method:'POST', header:{'Content-Type':'application/json'}, body:{mode:'raw', raw: JSON.stringify(labReq)} }); let labId=null; if (lr2.code>=200 && lr2.code<300){ try { labId=lr2.json().sectionId; } catch(e){} } labsByLecture[lecId]=labId? [labId] : []; await sleep(5);} \n",
              "\n",
              "  // Assign staff\n",
              "  function rotate(list){ if(!list||!list.length) return null; const id=list.shift(); list.push(id); return id;}\n",
              "  for (const lecId of lectures){ const p=rotate(staff.PROFESSOR) || rotate(staff.INSTRUCTOR); if (p){ await http({ url: baseUrl+'/courses/sections/assign-staff', method:'POST', header:{'Content-Type':'application/json'}, body:{mode:'raw', raw: JSON.stringify({ sectionId: lecId, userId: p, role: 'PROFESSOR' })} }); } const labs=labsByLecture[lecId]||[]; for(const labId of labs){ const t=rotate(staff.TA) || rotate(staff.INSTRUCTOR); if (t){ await http({ url: baseUrl+'/courses/sections/assign-staff', method:'POST', header:{'Content-Type':'application/json'}, body:{mode:'raw', raw: JSON.stringify({ sectionId: labId, userId: t, role: 'TEACHING_ASSISTANT' })} }); } await sleep(3);} await sleep(3);} \n",
              "\n",
              "  // Enroll students (3 random lectures)\n",
              "  function sample(arr,k){ const out=[]; const seen=new Set(); for(let i=0;i<k && seen.size<arr.length;i++){ let j; do{ j=Math.floor(Math.random()*arr.length);} while(seen.has(j)); seen.add(j); out.push(arr[j]); } return out;}\n",
              "  for (const sid of studentIds){ const picks=sample(lectures,3); for (const lec of picks){ const lab=(labsByLecture[lec]||[])[0]||null; const body={ studentId:sid, lectureSectionId: lec, labSectionId: lab }; await http({ url: baseUrl+'/enrollments/enroll', method:'POST', header:{'Content-Type':'application/json'}, body:{mode:'raw', raw: JSON.stringify(body)} }); await sleep(3);} }\n",
              "\n",
              "  console.log('âœ… Seed v2 complete');\n",
              "})();\n"
            ]
          }
        }
      ]
    }
  ],
  "variable": [
    { "key": "baseUrl", "value": "http://localhost:8080" },
    { "key": "academicYear", "value": "2025" },
    { "key": "term", "value": "Fall" }
  ]
}

