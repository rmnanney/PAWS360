{
  "info": {
    "name": "PAWS360 Seed Database",
    "_postman_id": "c46d4d7a-2f7a-4b51-9b5a-2f9b2a9bc0a5",
    "description": "Seeds the PAWS360 API with users, buildings, classrooms, courses, sections, staff assignments, and student enrollments.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Seed Database (All-in-One)",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            ""
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "// PAWS360 full DB seed script\n",
              "(async function () {\n",
              "  const baseUrl = pm.environment.get('baseUrl') || 'http://localhost:8080';\n",
              "  const academicYear = parseInt(pm.environment.get('academicYear') || '2025');\n",
              "  const term = pm.environment.get('term') || 'FALL';\n",
              "  pm.environment.set('baseUrl', baseUrl);\n",
              "  pm.environment.set('academicYear', academicYear);\n",
              "  pm.environment.set('term', term);\n",
              "\n",
              "  function sleep(ms){ return new Promise(r => setTimeout(r, ms)); }\n",
              "  function http(req){\n",
              "    return new Promise((resolve, reject) => {\n",
              "      pm.sendRequest(req, (err, res) => {\n",
              "        if (err) { console.error('HTTP error', err); return reject(err); }\n",
              "        resolve(res);\n",
              "      });\n",
              "    });\n",
              "  }\n",
              "  function randChoice(arr){ return arr[Math.floor(Math.random() * arr.length)]; }\n",
              "  function pad(n, w){ return String(n).padStart(w, '0'); }\n",
              "  function aliasFromDept(dept){\n",
              "    // Create a short alias from enum string\n",
              "    const parts = dept.split('_');\n",
              "    let alias = parts.map(p => p[0]).join('');\n",
              "    if (alias.length < 3) alias = (alias + 'XXX').slice(0,3);\n",
              "    return alias.slice(0,5).toUpperCase();\n",
              "  }\n",
              "\n",
              "  console.log('Seeding started to', baseUrl);\n",
              "\n",
              "  // Step 1: Create Users (>=20 for each user type)\n",
              "  const counts = {\n",
              "    STUDENT: 20,\n",
              "    PROFESSOR: 20,\n",
              "    INSTRUCTOR: 20,\n",
              "    TA: 20,\n",
              "    COUNSELOR: 20,\n",
              "    MENTOR: 20,\n",
              "    ADVISOR: 20,\n",
              "    FACULTY: 20,\n",
              "    STAFF: 20,\n",
              "    Administrator: 20,\n",
              "    Super_Administrator: 20\n",
              "  }; // 11 roles x 20 = 220\n",
              "  const staffRoles = ['PROFESSOR','INSTRUCTOR','TA'];\n",
              "  const users = [];\n",
              "  let userIdx = 1;\n",
              "  function makeUser(role, idx){\n",
              "    const email = role.toLowerCase() + idx + '@seed.uwm.edu';\n",
              "    return {\n",
              "      firstname: role + 'User' + idx,\n",
              "      middlename: '',\n",
              "      lastname: 'UWM',\n",
              "      dob: '1995-01-' + pad((idx % 28) + 1, 2),\n",
              "      email: email,\n",
              "      password: 'P@ssw0rd!' + idx,\n",
              "      addresses: [{\n",
              "        id: null,\n",
              "        address_type: 'HOME',\n",
              "        street_address_1: '1234 Seed St',\n",
              "        street_address_2: null,\n",
              "        po_box: null,\n",
              "        city: 'Milwaukee',\n",
              "        us_states: 'WI',\n",
              "        zipcode: '53211'\n",
              "      }],\n",
              "      countryCode: 'US',\n",
              "      phone: '414555' + pad(idx, 4),\n",
              "      status: 'ACTIVE',\n",
              "      role: role\n",
              "    };\n",
              "  }\n",
              "  Object.entries(counts).forEach(([role, cnt]) => { for (let i=1;i<=cnt;i++){ users.push(makeUser(role, userIdx++)); }});\n",
              "\n",
              "  const createdUsers = [];\n",
              "  const studentsEmails = [];\n",
              "  const staffByRole = { PROFESSOR: [], INSTRUCTOR: [], TA: [] };\n",
              "  for (const u of users){\n",
              "    const res = await http({\n",
              "      url: baseUrl + '/users/create',\n",
              "      method: 'POST',\n",
              "      header: { 'Content-Type': 'application/json' },\n",
              "      body: { mode: 'raw', raw: JSON.stringify(u) }\n",
              "    });\n",
              "    if (res.code >= 200 && res.code < 300 && res.json){\n",
              "      const body = res.json();\n",
              "      createdUsers.push(body);\n",
              "      if (u.role === 'STUDENT') studentsEmails.push(u.email);\n",
              "      if (staffRoles.includes(u.role)) staffByRole[u.role].push(body.user_id);\n",
              "    } else {\n",
              "      console.warn('Create user failed', res.code, res.text());\n",
              "    }\n",
              "    if (createdUsers.length % 25 === 0) await sleep(25);\n",
              "  }\n",
              "  console.log('Users created:', createdUsers.length);\n",
              "\n",
              "  // Resolve Student IDs by email\n",
              "  const studentIds = [];\n",
              "  for (const email of studentsEmails){\n",
              "    const res = await http({ url: baseUrl + '/users/student-id?email=' + encodeURIComponent(email), method: 'GET' });\n",
              "    try {\n",
              "      const j = res.json();\n",
              "      if (j && j.student_id && j.student_id !== -1) studentIds.push(j.student_id);\n",
              "    } catch (e) { /* ignore */ }\n",
              "    if (studentIds.length % 50 === 0) await sleep(25);\n",
              "  }\n",
              "  console.log('Students resolved:', studentIds.length);\n",
              "\n",
              "  // Step 2: Create Buildings (UWM main set)\n",
              "  const buildings = [\n",
              "    { code: 'EMS',   name: 'Engineering & Mathematical Sciences Building', campus: 'Milwaukee Main Campus', accessible: true, notes: '' },\n",
              "    { code: 'KIRC',  name: 'Kenwood Interdisciplinary Research Complex', campus: 'Milwaukee Main Campus', accessible: true, notes: '' },\n",
              "    { code: 'NWQ-A', name: 'Northwest Quadrant Building A', campus: 'Milwaukee Main Campus', accessible: true, notes: '' },\n",
              "    { code: 'NWQ-B', name: 'Northwest Quadrant Building B', campus: 'Milwaukee Main Campus', accessible: true, notes: '' },\n",
              "    { code: 'NWQ-C', name: 'Northwest Quadrant Building C', campus: 'Milwaukee Main Campus', accessible: true, notes: '' },\n",
              "    { code: 'NWQ-D', name: 'Northwest Quadrant Building D', campus: 'Milwaukee Main Campus', accessible: true, notes: '' },\n",
              "    { code: 'LUB',   name: 'Lubar Hall', campus: 'Milwaukee Main Campus', accessible: true, notes: '' },\n",
              "    { code: 'END',   name: 'Enderis Hall', campus: 'Milwaukee Main Campus', accessible: true, notes: '' },\n",
              "    { code: 'PHY',   name: 'Physics Building', campus: 'Milwaukee Main Campus', accessible: true, notes: '' },\n",
              "    { code: 'CHEM',  name: 'Chemistry Building', campus: 'Milwaukee Main Campus', accessible: true, notes: '' },\n",
              "    { code: 'CUN',   name: 'Cunningham Hall', campus: 'Milwaukee Main Campus', accessible: true, notes: '' },\n",
              "    { code: 'ART',   name: 'Art Building', campus: 'Milwaukee Main Campus', accessible: true, notes: '' },\n",
              "    { code: 'MIT',   name: 'Mitchell Hall', campus: 'Milwaukee Main Campus', accessible: true, notes: '' },\n",
              "    { code: 'UNION', name: 'UWM Student Union', campus: 'Milwaukee Main Campus', accessible: true, notes: '' },\n",
              "    { code: 'GML',   name: 'Golda Meir Library', campus: 'Milwaukee Main Campus', accessible: true, notes: '' },\n",
              "    { code: 'ZEL',   name: 'Helene Zelazo Center for the Performing Arts', campus: 'Milwaukee Main Campus', accessible: true, notes: '' },\n",
              "    { code: 'KLOT',  name: 'Klotsche Center', campus: 'Milwaukee Main Campus', accessible: true, notes: '' },\n",
              "    { code: 'SARB',  name: 'School of Architecture & Urban Planning', campus: 'Milwaukee Main Campus', accessible: true, notes: '' },\n",
              "    { code: 'MUS',   name: 'Music Building', campus: 'Milwaukee Main Campus', accessible: true, notes: '' },\n",
              "    { code: 'THEA',  name: 'Theatre Building', campus: 'Milwaukee Main Campus', accessible: true, notes: '' },\n",
              "    { code: 'FRESH', name: 'School of Freshwater Sciences (Harbor Campus)', campus: 'Harbor Campus', accessible: true, notes: '' },\n",
              "    { code: 'ZSPH',  name: 'Zilber School of Public Health (Downtown)', campus: 'Downtown', accessible: true, notes: '' },\n",
              "    { code: 'SFS',   name: 'School of Freshwater Sciences Academic Building', campus: 'Harbor Campus', accessible: true, notes: '' },\n",
              "    { code: 'NWQ-E', name: 'Northwest Quadrant Annex', campus: 'Milwaukee Main Campus', accessible: true, notes: '' }\n",
              "  ];\n",
              "  const buildingIds = [];\n",
              "  for (const b of buildings){\n",
              "    const res = await http({ url: baseUrl + '/courses/buildings', method: 'POST', header: { 'Content-Type': 'application/json' }, body: { mode: 'raw', raw: JSON.stringify(b) } });\n",
              "    if (res.code >= 200 && res.code < 300) {\n",
              "      try { buildingIds.push(res.json().id); } catch (e) { console.warn('Building parse failed'); }\n",
              "    } else { console.warn('Building create failed', b.code, res.code); }\n",
              "    await sleep(10);\n",
              "  }\n",
              "  console.log('Buildings created:', buildingIds.length);\n",
              "\n",
              "  // Step 3: Create Classrooms (>=15 per building)\n",
              "  const classroomIdsByBuilding = {};\n",
              "  const roomTypes = ['GENERAL_PURPOSE','COMPUTER_LAB','SCIENCE_LAB','LECTURE_HALL','STUDIO'];\n",
              "  for (const bid of buildingIds){\n",
              "    classroomIdsByBuilding[bid] = [];\n",
              "    for (let i=1;i<=15;i++){\n",
              "      const dto = {\n",
              "        buildingId: bid,\n",
              "        roomNumber: String(100 + i),\n",
              "        capacity: 25 + ((i % 6) * 5),\n",
              "        roomType: roomTypes[i % roomTypes.length],\n",
              "        features: ['Projector','Whiteboard']\n",
              "      };\n",
              "      const res = await http({ url: baseUrl + '/courses/classrooms', method: 'POST', header: { 'Content-Type': 'application/json' }, body: { mode: 'raw', raw: JSON.stringify(dto) } });\n",
              "      if (res.code >= 200 && res.code < 300){ try { classroomIdsByBuilding[bid].push(res.json().id); } catch(e){} }\n",
              "      await sleep(8);\n",
              "    }\n",
              "  }\n",
              "  const classroomTotal = Object.values(classroomIdsByBuilding).reduce((a,b)=>a + b.length, 0);\n",
              "  console.log('Classrooms created:', classroomTotal);\n",
              "\n",
              "  // Step 4: Create Courses (>=15 per department)\n",
              "  const departments = [\n",
              "    'BIOLOGICAL_SCIENCES','CHEMISTRY_BIOCHEMISTRY','COMPUTER_SCIENCE','ECONOMICS','ENGLISH','HISTORY','MATHEMATICAL_SCIENCES','PHILOSOPHY','PHYSICS','POLITICAL_SCIENCE','PSYCHOLOGY','SOCIOLOGY',\n",
              "    'ACCOUNTING','FINANCE','INFORMATION_TECHNOLOGY_MANAGEMENT','MARKETING','SUPPLY_CHAIN_OPERATIONS',\n",
              "    'CIVIL_ENGINEERING','ELECTRICAL_ENGINEERING','INDUSTRIAL_ENGINEERING','MATERIALS_ENGINEERING','MECHANICAL_ENGINEERING',\n",
              "    'COMMUNICATION_SCIENCES_DISORDERS','BIOMEDICAL_SCIENCES','OCCUPATIONAL_SCIENCE_TECHNOLOGY','KINESIOLOGY','NURSING',\n",
              "    'CURRICULUM_INSTRUCTION','EDUCATIONAL_POLICY_COMMUNITY_STUDIES','EDUCATIONAL_PSYCHOLOGY','ADMINISTRATIVE_LEADERSHIP',\n",
              "    'ART_DESIGN','DANCE','FILM_VIDEO_ANIMATION_NEW_GENRES','MUSIC','THEATRE',\n",
              "    'ARCHITECTURE','URBAN_PLANNING','FRESHWATER_SCIENCES','PUBLIC_HEALTH','INFORMATION_SCIENCE_TECHNOLOGY','GENERAL_STUDIES','UNDECLARED'\n",
              "  ];\n",
              "  const deliveryMethods = ['IN_PERSON','ONLINE','HYBRID','BLENDED'];\n",
              "  const courseIdByDept = {};\n",
              "  for (const dept of departments){\n",
              "    courseIdByDept[dept] = [];\n",
              "    for (let i=1;i<=15;i++){\n",
              "      const code = aliasFromDept(dept) + '-' + pad(100 + i, 3);\n",
              "      const req = {\n",
              "        courseCode: code,\n",
              "        courseName: dept.replace(/_/g, ' ') + ' ' + (100 + i),\n",
              "        courseDescription: 'Auto-seeded course for ' + dept,\n",
              "        department: dept,\n",
              "        courseLevel: 'UG',\n",
              "        creditHours: 3,\n",
              "        deliveryMethod: randChoice(deliveryMethods),\n",
              "        active: true,\n",
              "        catalogMaxEnrollment: 200,\n",
              "        academicYear: academicYear,\n",
              "        term: term\n",
              "      };\n",
              "      const res = await http({ url: baseUrl + '/courses', method: 'POST', header: { 'Content-Type': 'application/json' }, body: { mode: 'raw', raw: JSON.stringify(req) } });\n",
              "      if (res.code >= 200 && res.code < 300){\n",
              "        try { courseIdByDept[dept].push(res.json().courseId); } catch (e) { console.warn('Course parse failed', dept, code); }\n",
              "      } else { console.warn('Course create failed', dept, res.code); }\n",
              "      if (i % 5 === 0) await sleep(25);\n",
              "    }\n",
              "  }\n",
              "  const coursesCount = Object.values(courseIdByDept).reduce((a,b)=>a + b.length, 0);\n",
              "  console.log('Courses created:', coursesCount);\n",
              "\n",
              "  // Step 5: Create Sections (1 lecture + 2 labs per course)\n",
              "  const daySets = [ ['MONDAY','WEDNESDAY'], ['TUESDAY','THURSDAY'], ['FRIDAY'] ];\n",
              "  const lectureSections = [];\n",
              "  const labSectionsByLecture = {};\n",
              "  let sectionCounter = 1;\n",
              "  for (const dept of departments){\n",
              "    for (const courseId of courseIdByDept[dept]){\n",
              "      const bId = randChoice(buildingIds);\n",
              "      const cId = randChoice(classroomIdsByBuilding[bId]);\n",
              "      const lecReq = {\n",
              "        sectionId: null, courseId: courseId, sectionCode: 'LEC-' + pad(sectionCounter++, 3), sectionType: 'LECTURE',\n",
              "        parentSectionId: null, buildingId: bId, classroomId: cId, meetingDays: randChoice(daySets),\n",
              "        startTime: '09:00:00', endTime: '10:15:00', maxEnrollment: 30, waitlistCapacity: 10, autoEnrollWaitlist: true, consentRequired: false, term: term, academicYear: academicYear\n",
              "      };\n",
              "      const lecRes = await http({ url: baseUrl + '/courses/sections', method: 'POST', header: { 'Content-Type': 'application/json' }, body: { mode: 'raw', raw: JSON.stringify(lecReq) } });\n",
              "      let lectureId = null;\n",
              "      if (lecRes.code >= 200 && lecRes.code < 300){ try { lectureId = lecRes.json().sectionId; } catch(e){} }\n",
              "      if (!lectureId) continue;\n",
              "      lectureSections.push(lectureId);\n",
              "      labSectionsByLecture[lectureId] = [];\n",
              "      for (let l=1;l<=2;l++){\n",
              "        const b2 = randChoice(buildingIds);\n",
              "        const c2 = randChoice(classroomIdsByBuilding[b2]);\n",
              "        const labReq = {\n",
              "          sectionId: null, courseId: courseId, sectionCode: 'LAB-' + pad(l, 3), sectionType: 'LAB', parentSectionId: lectureId,\n",
              "          buildingId: b2, classroomId: c2, meetingDays: ['FRIDAY'], startTime: '11:00:00', endTime: '12:45:00',\n",
              "          maxEnrollment: 20, waitlistCapacity: 10, autoEnrollWaitlist: true, consentRequired: false, term: term, academicYear: academicYear\n",
              "        };\n",
              "        const labRes = await http({ url: baseUrl + '/courses/sections', method: 'POST', header: { 'Content-Type': 'application/json' }, body: { mode: 'raw', raw: JSON.stringify(labReq) } });\n",
              "        if (labRes.code >= 200 && labRes.code < 300){ try { labSectionsByLecture[lectureId].push(labRes.json().sectionId); } catch(e){} }\n",
              "        await sleep(8);\n",
              "      }\n",
              "      if (sectionCounter % 25 === 0) await sleep(25);\n",
              "    }\n",
              "  }\n",
              "  console.log('Lectures created:', lectureSections.length);\n",
              "  const labCount = Object.values(labSectionsByLecture).reduce((a,b)=>a + b.length, 0);\n",
              "  console.log('Labs created:', labCount);\n",
              "\n",
              "  // Step 6: Assign Staff to lectures and labs\n",
              "  function pickAndRotate(list){ if (!list || list.length === 0) return null; const id = list.shift(); list.push(id); return id; }\n",
              "  const profs = staffByRole.PROFESSOR.slice();\n",
              "  const instrs = staffByRole.INSTRUCTOR.slice();\n",
              "  const tas = staffByRole.TA.slice();\n",
              "  for (const lectureId of lectureSections){\n",
              "    let staffId = pickAndRotate(Math.random() < 0.6 ? profs : instrs) || pickAndRotate(instrs) || pickAndRotate(profs);\n",
              "    let role = (profs.includes(staffId) ? 'PROFESSOR' : 'INSTRUCTOR');\n",
              "    await http({ url: baseUrl + '/courses/sections/assign-staff', method: 'POST', header: { 'Content-Type': 'application/json' }, body: { mode: 'raw', raw: JSON.stringify({ sectionId: lectureId, userId: staffId, role }) } });\n",
              "    const labs = labSectionsByLecture[lectureId] || [];\n",
              "    for (const labId of labs){\n",
              "      let s2 = pickAndRotate(Math.random() < 0.8 ? tas : instrs) || pickAndRotate(instrs) || pickAndRotate(tas);\n",
              "      let r2 = (tas.includes(s2) ? 'TEACHING_ASSISTANT' : 'INSTRUCTOR');\n",
              "      await http({ url: baseUrl + '/courses/sections/assign-staff', method: 'POST', header: { 'Content-Type': 'application/json' }, body: { mode: 'raw', raw: JSON.stringify({ sectionId: labId, userId: s2, role: r2 }) } });\n",
              "      await sleep(5);\n",
              "    }\n",
              "  }\n",
              "  console.log('Staff assignments completed');\n",
              "\n",
              "  // Step 7: Enroll Students (4 courses each)\n",
              "  const enrollmentTargets = [];\n",
              "  for (const lec of lectureSections){\n",
              "    const labs = labSectionsByLecture[lec] || [];\n",
              "    if (labs.length){ enrollmentTargets.push({ lec, lab: labs[0] }); enrollmentTargets.push({ lec, lab: labs[1] }); } else { enrollmentTargets.push({ lec, lab: null }); }\n",
              "  }\n",
              "  function uniqueSample(arr, k){ const picked = new Set(); const res = []; for (let i=0;i<k && picked.size < arr.length;i++){ let idx; do { idx = Math.floor(Math.random()*arr.length); } while (picked.has(idx)); picked.add(idx); res.push(arr[idx]); } return res; }\n",
              "  let enrollCount = 0;\n",
              "  for (const sid of studentIds){\n",
              "    const picks = uniqueSample(enrollmentTargets, 4);\n",
              "    for (const p of picks){\n",
              "      const req = { studentId: sid, lectureSectionId: p.lec, labSectionId: p.lab };\n",
              "      await http({ url: baseUrl + '/enrollments/enroll', method: 'POST', header: { 'Content-Type': 'application/json' }, body: { mode: 'raw', raw: JSON.stringify(req) } });\n",
              "      enrollCount++;\n",
              "      if (enrollCount % 50 === 0) await sleep(20);\n",
              "    }\n",
              "  }\n",
              "  console.log('Enrollments attempted:', enrollCount);\n",
              "\n",
              "  pm.environment.set('seed_summary', JSON.stringify({\n",
              "    users_created: createdUsers.length,\n",
              "    students: studentIds.length,\n",
              "    professors: staffByRole.PROFESSOR.length,\n",
              "    instructors: staffByRole.INSTRUCTOR.length,\n",
              "    tas: staffByRole.TA.length,\n",
              "    buildings: buildingIds.length,\n",
              "    classrooms: Object.values(classroomIdsByBuilding).reduce((a,b)=>a+b.length,0),\n",
              "    courses: Object.values(courseIdByDept).reduce((a,b)=>a+b.length,0),\n",
              "    lectures: lectureSections.length,\n",
              "    labs: Object.values(labSectionsByLecture).reduce((a,b)=>a+b.length,0),\n",
              "    enrollments_attempted: enrollCount\n",
              "  }, null, 2));\n",
              "\n",
              "  console.log('Seeding complete');\n",
              "})().catch(e => { console.error('Seeding error', e); });\n"
            ]
          }
        }
      ]
    }
  ],
  "variable": [
    { "key": "baseUrl", "value": "http://localhost:8080" },
    { "key": "academicYear", "value": "2025" },
    { "key": "term", "value": "FALL" }
  ]
}
